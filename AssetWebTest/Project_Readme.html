<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="Content/deAsset.css">
    <title>Your ASP.NET application</title>
    <style>
        #reportbutton {
            cursor: pointer;
        }
            #reportbutton:active {
                transform: translateY(4px);
            }
    </style>
    <script type='text/javascript' src='Scripts/jquery-1.10.2.min.js'></script>
    <script type='text/javascript' src='Scripts/bootstrap.min.js'></script>
    <script type='text/javascript' src='Scripts/knockout-min.js'></script>
    <script type='text/javascript' src='Scripts/autoNumeric.js'></script>
    <script type='text/javascript' src='Scripts/ajax_download.js'></script>
    <script type='text/javascript' src='Scripts/report.js'></script>
    <script type='text/javascript' src='Scripts/jquery.hint.js'></script>
    <script type='text/javascript' src='Scripts/proto.js'></script>
    <script type='text/javascript' src='Scripts/double_input.js'></script>
</head>
<body>

     <!-- Asset Intelligence -->
    <div class="asset-intelligence">
        <div class='asset-toggle' data-bind='click: function(data){this.AssetInfo(123)}'>
            <i class="fa fa-caret-right" aria-hidden="true"></i>
            <span class="toggle-text" id='toogle-text'>
                <strong>Asset Intelligence</strong>
            </span>
        </div>

        <i id='spinner-<%=rsProp("ippid")%>' class="fa fa-spinner fa-spin" style="font-size:20px; color:steelblue; display:none;"></i>

        <div class='asset-content' id='asset-'>
            <div class="asset-row">
                <div>
                    <div class='col-lg'>
                        <div class='uppercase'><strong><a href='#'>Heater/Air Conditioner With Long Type Name</a></strong></div>
                        <br />
                        <label class='asset-label'>Tag ID</label>
                        <a href="#" name="TagIDt">RTU01</a>
                    </div>
                    <div class='col-sm asset-condition'>
                        <label class='asset-label'>Condition</label>
                        <div><strong>Poor</strong></div>
                        <br />
                        <label class='asset-label'>Updated</label>
                        <div class='uppercase'>Mar 28 2016</div>
                    </div>
                    <div class='col-sm asset-warranty'>
                        <label class='asset-label'>Warranty</label>
                        <div><strong data-bind="text: waranty">NONE</strong></div>
                        <br />
                        <label class='asset-label'>Expires</label>
                        <strong class='uppercase'>Jan 01 2018</strong>
                    </div>
                    <div class='col-sm'>
                        <label class='asset-label'>Age</label>
                        <div><strong>Jan 01 2018</strong></div>
                        <br />
                        <label class='asset-label'>Life Expected</label>
                        <strong class="asset-label-life">Jan 01 2018</strong>
                        <br />
                    </div>
                </div>
            </div>
            <div class='asset-row'>
                <div>
                    <div class='col-lg asset-wos'>
                        <div>
                            <label class='asset-label'>Completed Work Orders</label>
                            <div><strong>16,931 usd</strong></div>
                            <a href='#'>View 31</a>
                        </div>
                        <div>
                            <label class='asset-label'>In-Progress Work Orders</label>
                            <div><strong>1,844 usd</strong></div>
                            <a href='#'>View 1</a>
                        </div>
                    </div>
                    <div class='col-lg'>


                        <div class='asset-bars'>
                            <label class='asset-label'>Initial Cost</label>
                            <span><strong>18,931</strong></span>


                            <!--
                            the horizontal grey bar is currently set up to use 1 of 4 css classes for its width
                            in 25% increments:
                            width-25
                            width-50
                            width-75
                            width-100
                            (or no width class for default 0%)
                            -->
                            <span class="asset-bar" id="asset-bar-initial">
                                <div></div>
                            </span>
                        </div>
                        <div class='asset-bars'>
                            <label class='asset-label'>Total Spend</label>
                            <span><strong>9,724</strong></span>
                            <span class="asset-bar" id="asset-bar-total">
                                <div></div>
                            </span>
                        </div>
                        <div class='asset-bars'>
                            <label class='asset-label'>This Proposals</label>
                            <span><strong>5,852</strong></span>
                            <span class="asset-bar" id="asset-bar-prop">
                                <div></div>
                            </span>
                        </div>


                    </div>
                    <div class='col-sm'>
                        <label class='asset-label'>All Proposals for this Asset</label>
                        <div><strong>1,844 usd</strong></div>
                        <a href='#'>View 6</a>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- END Asset Intelligence --> 

    <!-- Check Download Excel File -->
    <table>
        <tr>
            <td>
                <div>
                    <input type="button" name="LaunchExcel" value="Launch Excel" onClick="ExcelLaunch()">
                </div>
            </td>
            <td>
                <div>
                    <input type="button" name="Cancel" value=" Cancel " onClick="PropInp()">
                </div>
            </td>
        </tr>
        <tr>
            <td>
                <div>
                    <input type="button" name="LineItemReport" value=" Line Item Report " onClick="ExcelLineReport()">
                </div>
                <div>
                    <input type="button" id="reportbutton" name="LineItemReport" value=" Line Item Report " onClick="ExcelLineReport()">
                </div>
            </td>
        </tr>
        <tr>
            <td>
                <div>
                    <!--
                    <input type="text" class="DEMO" data-a-sign="$ " data-a-dec="," data-a-sep=".">
                    -->
                    <input type="text" class="DEMO">
                    <script>
                        jQuery(function($) {
                        //    $('.DEMO').autoNumeric('init', { vMin: 0.00, vMax: 99999.99 });
                            $('.DEMO').autoNumeric('init', { wEmpty: 'empty', vMax: 99999.99 });
                        });
                        $('.DEMO').hint('-');
                    </script>
                </div>
                <div>
                    <input type="text" class="DEMO1">
                </div>
                <div>
                    <input type="text" class="DEMO3">
                    <script>
                        double_input('.DEMO3',5,2);
                        $('.DEMO3').hint('-');
                    </script>
                </div>
            </td>
        </tr>
    </table>

</body>

</html>

Today's message is: <span data-bind="text: myMessage"></span>


<script language="JavaScript">
<!--
    function getBeforeAfter() {
        var value = $(this),
            left = value.substring(0, this.selection.start),
            right = value.substring(this.selection.end, value.length);
        return [left, right];
    }

$(document).ready(function () {
    $.extend($.fn.autoNumeric.defaults, {
        aSep: '@System.Threading.Thread.CurrentThread.CurrentCulture.NumberFormat.NumberGroupSeparator',
        aDec: '@System.Threading.Thread.CurrentThread.CurrentCulture.NumberFormat.NumberDecimalSeparator'
    });

    $(".DEMO").keypress(function (event) {
        var gg = $('.DEMO').autoNumeric('get');
    });


    $(".DEMO").bind('paste', function (e)
    {
        //alert('paste event caught')
        var parts = getBeforeAfter();
        var pastedData = e.originalEvent.clipboardData.getData('text');
        var $this = $(this);
        var fff = $this.val();
        var gg = $('.DEMO').autoNumeric('get');
        if (pastedData > 10) return false;
    });

    $('.DEMO2').keydown(function (e) {
        console.log(e.keyCode)
        if (e.target.selectionStart !== e.target.selectionEnd) return true
        if (e.keyCode === 8 || e.keyCode === 190) return true;

        var arr = e.target.value.split('.');
        if (arr.length === 1) {
            return arr[0].length <= 4
        } else {
            return arr[0].length <= 5 && arr[1].length <= 1
        }
    })

    $('.DEMO1').hint('-');

    function insert(str, index, value) {
        return str.substr(0, index) + value + str.substr(index);
    }
    function isNumber(n) {
        return !isNaN(parseFloat(n)) && isFinite(n);
    }
    $('.DEMO1').on('keypress', function (e) {
        if (!e) var e = window.event;
        if (e.keyCode > 0 && e.which == 0) return true;
        if (e.keyCode) code = e.keyCode;
        else if (e.which) code = e.which;
        var character = String.fromCharCode(code);
        if (character !='.' && !isNumber(character)) return false;
        if (character == '\b' || character == ' ' || character == '\t') return true;
        if (keyDown && (code == vKey || code == Vkey)) return (character);
        else {
            if (/[0-9]$/.test(character)) {
                var start = e.target.selectionStart;
                var end = e.target.selectionEnd;
                var val = e.target.value;
                val = val.replace(val.substring(start, end), "");
                //merge value
                var mergarr = insert(val, start, character).split('.');
                if (mergarr.length === 1 && mergarr[0].length > 5) return false;
                if (mergarr.length === 2)
                {
                    if (mergarr[1].length > 2) return false;
                    if (mergarr[0].length > 5) return false;
                }
                if (mergarr.length > 2) return false;
            }
            else false;
        }
    }).on('paste', function (e) {
        var $this = $(this);
        var pastedData = e.originalEvent.clipboardData.getData('text');
        var arr = pastedData.split('.');
        if (arr.length === 1 && arr[0].length > 5) return false;
        if (arr.length === 2) {
            if (arr[1].length > 2) return false;
            if (arr[0].length > 5) return false;
        }
        if (arr.length > 2) return false;

        //check inside data
        var start = e.target.selectionStart;
        var end = e.target.selectionEnd;
        var val = e.target.value;
        val = val.replace(val.substring(start, end), "");
        //merge value
        var mergeval = insert(val, start, pastedData);
        var mergarr = mergeval.split('.');
        if (mergarr.length === 1 && mergarr[0].length > 5) return false;
        if (mergarr.length === 2) {
            if (mergarr[1].length > 2) return false;
            if (mergarr[0].length > 5) return false;
        }
        if (mergarr.length > 2) return false;

        setTimeout(function () {
            $this.val($this.val().replace(/[^0-9]/g, ''));
        }, 5);
    });


    $('.DEMO2').change(function () {
        var max = 999999;//parseInt($(this).attr('max'));
        var min = 0;//parseInt($(this).attr('min'));
        if ($(this).val() > max) {
            $(this).val(max);
        }
        else if ($(this).val() < min) {
            $(this).val(min);
        }
    });


});

function ExcelLaunch() {
    document.LaunchExcel.action = "get_report.asp";
    document.LaunchExcel.target = "_New";
    document.LaunchExcel.focus;
    document.LaunchExcel.submit();
}

function PropInp(){
document.location.href="HtmlTestPage1.html";
}

</script>

<script type="text/javascript">

    //JS knockout
    function AppViewModel() {
        this.myMessage = ko.observable('How are you');
        this.waranty = ko.observable('18month');

        this.WOs = ko.observableArray([]);


        this.AssetInfo = function (propId) {

            var inmiu = 123;
            var n = inmiu.toString();
            this.waranty(n + " USD");
            this.WOs([80870701, 80863739]);

            var now = new Date();
            var gg = now.toDateString();
            var javascriptVar = '<%=String.Format("{0:MM/dd/yyyy}", now); %>';
            this.waranty(gg);

            $('#asset- .asset-condition').addClass("broken");

            //jQuery
            //            $('#asset-').toggle("slow"); //animation
            $('#asset-').toggle();

            //style
            if ($("#asset-").css('display') == 'block') {
                $('.asset-toggle1 > .fa-caret-right').css({ 'transform': 'rotate(90deg)' });
                $('.asset-toggle1').css({ 'background-color': '#f6f6f6' });

            }
            else {
                $('.asset-toggle1 > .fa-caret-right').css({ 'transform': 'rotate(0)' });
                $('.asset-toggle1').css({ 'background-color': 'transparent' });
            }
            if ($('#asset-').is(':visible')) {
            }
            var dd = $('#asset-').attr('style').indexOf('display: block');
            if ($('#asset-').attr('style').indexOf('display') !== -1) {
                //...
            }

            //change with depends on value. Default width-100 - InitialCost, width-50 - total spend
            //width-25 - Amount
            var InitialCost = 18931;
            var TotalSpend = 9724;
            var Amount = 5852;
            var wInit = '100';
            var wTotal = '50';
            var wProp = '25';
            if (InitialCost > TotalSpend && InitialCost > Amount) {
                wInit = '100';
                if (TotalSpend < Amount) {
                    wTotal = '25';
                    wProp = '50';
                }
            }
            if (TotalSpend > InitialCost && TotalSpend > Amount) {
                wTotal = '100';
                if (InitialCost > Amount) {
                    wInit = '50';
                    wProp = '25';
                } else {
                    wInit = '25';
                    wProp = '50';
                }
            }
            if (Amount > InitialCost && Amount > TotalSpend) {
                wProp = '100';
                if (InitialCost > Amount) {
                    wInit = '50';
                    wTotal = '25';
                } else {
                    wInit = '25';
                    wTotal = '50';
                }
            }

            $('#asset-bar-initial').addClass("width-" + wInit);
            $('#asset-bar-total').addClass("width-" + wTotal);
            $('#asset-bar-prop').addClass("width-" + wProp);

            //$('.asset-bar.width-100 > div').css({ 'width': w100 });
            //$('.asset-bar.width-50 > div').css({ 'width': w50 });
            //$('.asset-bar.width-25 > div').css({ 'width': w25 });
            //$('#asset-bar-initial').addClass("width-25");

            var params = {
                'ProposalId': propId
            };
            params = JSON.stringify(params); var lPathName = window.location.pathname.toLowerCase();
            var baseUrl1 = lPathName;
            var baseUrl2 = window.location.origin + "/Home/GetTest?proposalId=" + 123;

            $.ajax({
                type: 'POST',
                dataType: 'JSON',
                contentType: 'application/json; charset=utf-8',
                url: baseUrl2,
                data: params,
                success: function (data) {

                    var assetSummary = jQuery.parseJSON(data.jsonPR);
                    if (assetSummary != null) {
                        //if(assetSummary.Name.Lenght ==0)
                        {
                            var value = 1250223;
                            var num = assetSummary.Money.toFixed(2).replace(/(\d)(?=(\d\d\d)+(?!\d))/g, "$1,");
                            var num1 = assetSummary.Money.toLocaleString();
                        }
                    }
                }
            });
        }
    }

    // Activates knockout.js
    ko.applyBindings(new AppViewModel());
</script>
